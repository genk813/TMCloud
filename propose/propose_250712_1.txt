先にザックリまとめ
―― **最優先で実装すべきは「称呼（発音同一）」用の発音ゆらぎ統一と、あらゆる文字列に共通する基本正規化（ひらがな→カタカナ、大文字化、長音・ハイフン統一など）**。ここが出来ればヒット率が一気に TM SONAR 水準に近づく。次に法人名・住所・商品役務テキストでの追加ルール、その後ようやくコード系・統計系の条件を整える――という順がコスパ高いよ。以下に “対応すべきもの” を網羅し、**P1（最優先）→P4（後回し可）** で優先度を付けた。

---

## P1　呼称・商標文字列の基礎正規化 & 発音ゆらぎ統一

| ID | 内容                     | 適用フィールド  | 根拠 |
| -- | ---------------------- | -------- | -- |
| 1  | ひらがな→カタカナ変換            | 商標・称呼 全般 |    |
| 2  | 全小文字→大文字（カナ・英字）        | 同上       |    |
| 3  | 長音「ー」、横線、ハイフンを “-” に統一 | 同上       |    |
| 4  | スペース除去                 | 同上       |    |
| 5  | 特殊記号（▲▼§￠＼∞ 等）排除       | 同上       |    |
| 6  | 句読点・中点・カンマ・クォーテーション排除  | 同上       |    |
| 7  | ギリシャ・ラテン文字→対応アルファベット   | 同上       |    |
| 8  | 旧字体漢字→新字体              | 同上       |    |
| 9  | ローマ数字→算用数字（Ⅲ世→３世）      | 商標       |    |

> **実装メモ**：P1 は全文検索用インデックス生成時に正規化パイプラインを作り、一度変換表をユニットテストに落としておくと安全。

---

## P1　称呼（発音同一）専用の追加ルール

| ID | 内容                     | 例         | 根拠 |
| -- | ---------------------- | --------- | -- |
| 10 | **発音同一**：ヲ=オ、ヂ=ジ、ヅ=ズ…  | チヂミ＝チジミ   |    |
| 11 | **微差音統一**：ヴァ=バ、ツィ=チ…   | ヴェール＝ベール  |    |
| 12 | **長音・促音・長音化母音の有無** を無視 | エイ→エー／エエ  |    |
| 13 | **拗音大文字化** 後に一致判定      | フイルム＝フィルム |    |

> **優先理由**：TM SONAR の目玉機能。ここを落とすと称呼検索の再現性が低下する。

---

## P2　固有テキスト別の追加正規化

| ID | 内容                                | 適用フィールド    | 根拠 |
| -- | --------------------------------- | ---------- | -- |
| 14 | 法人種別語句排除（株式会社・有限会社など）             | 出願人／代理人    |    |
| 15 | **丁目**だけ漢数字→算用数字（〜44 丁目）          | 出願人住所      |    |
| 16 | 商品役務テキストの「，」「、」で分割・AND 処理         | 指定商品／役務    |    |
| 17 | 商品役務テキストでも P1 基礎正規化(1-5)          | 同上         |    |
| 18 | 英語商品役務：ハイフン削除・記号 (# \$ % + &) は残す | 指定商品／役務（英） |    |

---

## P3　コード・数値系の統一

| ID | 内容                         | フィールド   | 根拠 |
| -- | -------------------------- | ------- | -- |
| 19 | マドプロ拒絶条文コード→国内コード変換        | 拒絶条文コード |    |
| 20 | 国際分類（NICE 12版）→類似群へ展開      | 国際分類    |    |
| 21 | ウィーンコード：前方一致で下位階層省略可       | ウィーンコード |    |
| 22 | 審決分類：審判種別+判示コード+結論コードの 3 段 | 審決分類    |    |

> **実装ヒント**：コード類は正規化テーブルを持ち、入力を look-up して変換する形が定番。

---

## P4　統計・レンジ指定系（後回し可）

| ID | 内容                           | フィールド    | 根拠 |
| -- | ---------------------------- | -------- | -- |
| 23 | 称呼音数・区分数・情報提供数などの範囲指定 (n\:m) | 音数・区分数 等 |    |
| 24 | 法区分＋類：法令ごとの分類記号展開            | 法区分＋類    |    |

これらはインデックスを整えた後、検索 UI 側でレンジクエリを投げるだけなので MVP では後回しでも OK。

---

### 実装ロードマップの例

1. **Week 1-2** ― P1 (基礎正規化) をユーティリティ関数として完成
2. **Week 3** ― P1 (発音同一ロジック) を N-gram or 変換マッピングで実装
3. **Week 4** ― P2 の法人名・住所・商品役務専用フィルターを追加
4. **Week 5-6** ― P3 コード系テーブルを作成し UI に補助ボタン実装
5. **Week 7+** - P4 統計レンジと高度検索フォームを仕上げ

これで “検索条件だけは TM SONAR 並み” の基盤が整うはず。まずは P1 を徹底的にテストしてみて！
